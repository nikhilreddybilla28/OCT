[2022-08-23 05:54:58] ======================= args =======================
{
    "cfg": "configs/UDA_OCT_DANN.yaml",
    "seed": 123,
    "source": [
        "f"
    ],
    "target": [
        "b"
    ],
    "output_root": "exps/bin",
    "output_dir": null,
    "data_root": "/data/neuroretinal/UDA/binary",
    "opts": null
}
[2022-08-23 05:54:58] ======================= cfg =======================
DATASET:
    NAME: binary
    NUM_CLASSES: 2
    ROOT: /data/neuroretinal/UDA/binary
    SOURCE:
    - Foveal
    TARGET:
    - Biop
    TRIM: 0
METHOD:
    ENT: false
    HDA:
        LR_MULT: 1.0
        W_HDA: 1.0
    W_ALG: 0.1
MODEL:
    BASENET: resnet50
    BASENET_DOMAIN_EBD: false
    DNET: Discriminator
    D_HIDDEN_SIZE: 1024
    D_INDIM: 1024
    D_OUTDIM: 1
    D_WGAN_CLIP: 0.01
    EXT_DPR: 0.1
    EXT_FEATURE: 768
    EXT_LAYER: false
    EXT_LR: 10.0
    EXT_NUM_HEADS: 24
    EXT_NUM_LAYERS: 1
    EXT_NUM_TOKENS: 100
    EXT_SKIP: true
    PRETRAIN: true
    VIT_DPR: 0.1
    VIT_PRETRAIN_EXLD: []
    VIT_USE_CLS_TOKEN: true
OPTIM:
    MOMENTUM: 0.9
    WEIGHT_DECAY: 5.0e-05
SEED: 123
TASK:
    NAME: UDA
    SSDA_SHOT: 1
TRAIN:
    BATCH_SIZE_SOURCE: 36
    BATCH_SIZE_TARGET: 36
    BATCH_SIZE_TEST: 36
    LR: 0.001
    OUTPUT_CKPT: exps/bin/ckpt/Foveal2Biop_123
    OUTPUT_DIR: Foveal2Biop_123
    OUTPUT_LOG: exps/bin/log/Foveal2Biop_123
    OUTPUT_RESFILE: exps/bin/log/Foveal2Biop_123/log.txt
    OUTPUT_ROOT: exps/bin
    OUTPUT_TB: exps/bin/tensorboard/Foveal2Biop_123
    PRINT_FREQ: 50
    SAVE_FREQ: 5000
    TEST_FREQ: 500
    TTL_ITE: 8000
TRAINER: DANN
WORKERS: 1

[2022-08-23 05:54:58] --> trainer: DANN
[2022-08-23 05:54:58] --> building dataset from: binary
[2022-08-23 05:54:58]     source ['Foveal']: 67/68
[2022-08-23 05:54:58]     target ['Biop']: 45/46
[2022-08-23 05:54:58] --> building models: resnet50
[2022-08-23 05:54:59]     models keys / loaded keys: 320/265
[2022-08-23 05:55:00]     base_net paras: 23.51M
[2022-08-23 05:55:00]     d_net paras: 3.15M
[2022-08-23 05:55:00] --> training from scratch
[2022-08-23 05:55:05] I:  0/8000 | lr: 0.00100 | l_cls_src: 0.932 | l_cls_tar: 1.180 | l_alg: 0.911 | l_ttl: 1.024 | ent_tar: 0.523 | best_acc: 0.000 
[2022-08-23 05:58:20] I:  50/8000 | lr: 0.00096 | l_cls_src: 0.360 | l_cls_tar: 0.445 | l_alg: 0.763 | l_ttl: 0.436 | ent_tar: 0.333 | best_acc: 0.000 
[2022-08-23 05:59:43] I:  100/8000 | lr: 0.00092 | l_cls_src: 0.016 | l_cls_tar: 0.478 | l_alg: 0.710 | l_ttl: 0.087 | ent_tar: 0.223 | best_acc: 0.000 
[2022-08-23 06:00:34] I:  150/8000 | lr: 0.00088 | l_cls_src: 0.118 | l_cls_tar: 0.652 | l_alg: 0.673 | l_ttl: 0.185 | ent_tar: 0.213 | best_acc: 0.000 
[2022-08-23 06:01:24] I:  200/8000 | lr: 0.00085 | l_cls_src: 0.075 | l_cls_tar: 0.349 | l_alg: 0.696 | l_ttl: 0.144 | ent_tar: 0.264 | best_acc: 0.000 
[2022-08-23 06:02:14] I:  250/8000 | lr: 0.00082 | l_cls_src: 0.027 | l_cls_tar: 0.434 | l_alg: 0.632 | l_ttl: 0.091 | ent_tar: 0.236 | best_acc: 0.000 
[2022-08-23 06:03:05] I:  300/8000 | lr: 0.00079 | l_cls_src: 0.011 | l_cls_tar: 0.222 | l_alg: 0.525 | l_ttl: 0.064 | ent_tar: 0.252 | best_acc: 0.000 
[2022-08-23 06:03:55] I:  350/8000 | lr: 0.00076 | l_cls_src: 0.025 | l_cls_tar: 0.317 | l_alg: 0.509 | l_ttl: 0.076 | ent_tar: 0.194 | best_acc: 0.000 
[2022-08-23 06:04:45] I:  400/8000 | lr: 0.00074 | l_cls_src: 0.024 | l_cls_tar: 0.387 | l_alg: 0.526 | l_ttl: 0.076 | ent_tar: 0.200 | best_acc: 0.000 
[2022-08-23 06:05:36] I:  450/8000 | lr: 0.00072 | l_cls_src: 0.067 | l_cls_tar: 0.937 | l_alg: 0.586 | l_ttl: 0.126 | ent_tar: 0.162 | best_acc: 0.000 
[2022-08-23 06:06:25] --> testing on source_test
[2022-08-23 06:07:02]     I:  49/68 | acc: 96.939
[2022-08-23 06:07:16] --> testing on target_test
[2022-08-23 06:07:26] I:  499/8000 | src_acc: 97.657 | tar_acc: 90.942 | best_acc: 90.942
[2022-08-23 06:07:27]     models saved to exps/bin/ckpt/Foveal2Biop_123/models-last.pt
[2022-08-23 06:07:27]     keys: dict_keys(['optimizer', 'ite', 'best_acc', 'base_net', 'd_net'])
[2022-08-23 06:07:27]     best models saved to exps/bin/ckpt/Foveal2Biop_123/models-best.pt
[2022-08-23 06:07:28] I:  500/8000 | lr: 0.00069 | l_cls_src: 0.004 | l_cls_tar: 0.319 | l_alg: 0.490 | l_ttl: 0.053 | ent_tar: 0.148 | best_acc: 90.942 
[2022-08-23 06:08:18] I:  550/8000 | lr: 0.00068 | l_cls_src: 0.001 | l_cls_tar: 0.398 | l_alg: 0.511 | l_ttl: 0.052 | ent_tar: 0.108 | best_acc: 90.942 
[2022-08-23 06:09:09] I:  600/8000 | lr: 0.00066 | l_cls_src: 0.008 | l_cls_tar: 0.424 | l_alg: 0.613 | l_ttl: 0.069 | ent_tar: 0.112 | best_acc: 90.942 
[2022-08-23 06:09:59] I:  650/8000 | lr: 0.00064 | l_cls_src: 0.003 | l_cls_tar: 0.437 | l_alg: 0.447 | l_ttl: 0.048 | ent_tar: 0.157 | best_acc: 90.942 
[2022-08-23 06:10:50] I:  700/8000 | lr: 0.00062 | l_cls_src: 0.025 | l_cls_tar: 0.301 | l_alg: 0.458 | l_ttl: 0.071 | ent_tar: 0.068 | best_acc: 90.942 
[2022-08-23 06:11:40] I:  750/8000 | lr: 0.00061 | l_cls_src: 0.005 | l_cls_tar: 0.581 | l_alg: 0.502 | l_ttl: 0.055 | ent_tar: 0.105 | best_acc: 90.942 
[2022-08-23 06:12:30] I:  800/8000 | lr: 0.00059 | l_cls_src: 0.008 | l_cls_tar: 0.183 | l_alg: 0.455 | l_ttl: 0.054 | ent_tar: 0.097 | best_acc: 90.942 
[2022-08-23 06:13:21] I:  850/8000 | lr: 0.00058 | l_cls_src: 0.125 | l_cls_tar: 0.394 | l_alg: 0.559 | l_ttl: 0.180 | ent_tar: 0.113 | best_acc: 90.942 
[2022-08-23 06:14:11] I:  900/8000 | lr: 0.00057 | l_cls_src: 0.007 | l_cls_tar: 0.416 | l_alg: 0.541 | l_ttl: 0.061 | ent_tar: 0.075 | best_acc: 90.942 
[2022-08-23 06:15:02] I:  950/8000 | lr: 0.00056 | l_cls_src: 0.024 | l_cls_tar: 0.378 | l_alg: 0.536 | l_ttl: 0.078 | ent_tar: 0.109 | best_acc: 90.942 
[2022-08-23 06:15:49] --> testing on source_test
[2022-08-23 06:16:27]     I:  49/68 | acc: 99.036
[2022-08-23 06:16:40] --> testing on target_test
[2022-08-23 06:16:51] I:  999/8000 | src_acc: 98.890 | tar_acc: 91.616 | best_acc: 91.616
[2022-08-23 06:16:51]     models saved to exps/bin/ckpt/Foveal2Biop_123/models-last.pt
[2022-08-23 06:16:51]     keys: dict_keys(['optimizer', 'ite', 'best_acc', 'base_net', 'd_net'])
[2022-08-23 06:16:51]     best models saved to exps/bin/ckpt/Foveal2Biop_123/models-best.pt
[2022-08-23 06:16:52] I:  1000/8000 | lr: 0.00054 | l_cls_src: 0.013 | l_cls_tar: 0.239 | l_alg: 0.566 | l_ttl: 0.070 | ent_tar: 0.085 | best_acc: 91.616 
[2022-08-23 06:17:43] I:  1050/8000 | lr: 0.00053 | l_cls_src: 0.043 | l_cls_tar: 0.381 | l_alg: 0.603 | l_ttl: 0.104 | ent_tar: 0.076 | best_acc: 91.616 
[2022-08-23 06:18:33] I:  1100/8000 | lr: 0.00052 | l_cls_src: 0.054 | l_cls_tar: 1.049 | l_alg: 0.695 | l_ttl: 0.124 | ent_tar: 0.072 | best_acc: 91.616 
[2022-08-23 06:19:23] I:  1150/8000 | lr: 0.00051 | l_cls_src: 0.014 | l_cls_tar: 0.648 | l_alg: 0.590 | l_ttl: 0.073 | ent_tar: 0.104 | best_acc: 91.616 
[2022-08-23 06:20:13] I:  1200/8000 | lr: 0.00050 | l_cls_src: 0.001 | l_cls_tar: 0.303 | l_alg: 0.616 | l_ttl: 0.062 | ent_tar: 0.035 | best_acc: 91.616 
[2022-08-23 06:21:03] I:  1250/8000 | lr: 0.00049 | l_cls_src: 0.002 | l_cls_tar: 0.332 | l_alg: 0.646 | l_ttl: 0.067 | ent_tar: 0.051 | best_acc: 91.616 
[2022-08-23 06:21:54] I:  1300/8000 | lr: 0.00048 | l_cls_src: 0.004 | l_cls_tar: 0.931 | l_alg: 0.632 | l_ttl: 0.067 | ent_tar: 0.068 | best_acc: 91.616 
[2022-08-23 06:22:45] I:  1350/8000 | lr: 0.00048 | l_cls_src: 0.001 | l_cls_tar: 0.058 | l_alg: 0.599 | l_ttl: 0.061 | ent_tar: 0.059 | best_acc: 91.616 
[2022-08-23 06:23:35] I:  1400/8000 | lr: 0.00047 | l_cls_src: 0.003 | l_cls_tar: 0.715 | l_alg: 0.599 | l_ttl: 0.063 | ent_tar: 0.071 | best_acc: 91.616 
[2022-08-23 06:24:25] I:  1450/8000 | lr: 0.00046 | l_cls_src: 0.016 | l_cls_tar: 0.182 | l_alg: 0.617 | l_ttl: 0.078 | ent_tar: 0.061 | best_acc: 91.616 
[2022-08-23 06:25:13] --> testing on source_test
[2022-08-23 06:25:50]     I:  49/68 | acc: 98.186
[2022-08-23 06:26:04] --> testing on target_test
[2022-08-23 06:26:15] I:  1499/8000 | src_acc: 98.397 | tar_acc: 90.698 | best_acc: 91.616
[2022-08-23 06:26:15]     models saved to exps/bin/ckpt/Foveal2Biop_123/models-last.pt
[2022-08-23 06:26:15]     keys: dict_keys(['optimizer', 'ite', 'best_acc', 'base_net', 'd_net'])
[2022-08-23 06:26:16] I:  1500/8000 | lr: 0.00045 | l_cls_src: 0.017 | l_cls_tar: 0.214 | l_alg: 0.673 | l_ttl: 0.084 | ent_tar: 0.054 | best_acc: 91.616 
[2022-08-23 06:27:06] I:  1550/8000 | lr: 0.00045 | l_cls_src: 0.003 | l_cls_tar: 0.883 | l_alg: 0.640 | l_ttl: 0.067 | ent_tar: 0.077 | best_acc: 91.616 
[2022-08-23 06:27:56] I:  1600/8000 | lr: 0.00044 | l_cls_src: 0.005 | l_cls_tar: 0.809 | l_alg: 0.674 | l_ttl: 0.072 | ent_tar: 0.075 | best_acc: 91.616 
[2022-08-23 06:28:47] I:  1650/8000 | lr: 0.00043 | l_cls_src: 0.017 | l_cls_tar: 0.883 | l_alg: 0.610 | l_ttl: 0.078 | ent_tar: 0.050 | best_acc: 91.616 
[2022-08-23 06:29:37] I:  1700/8000 | lr: 0.00043 | l_cls_src: 0.054 | l_cls_tar: 0.107 | l_alg: 0.600 | l_ttl: 0.114 | ent_tar: 0.051 | best_acc: 91.616 
[2022-08-23 06:30:27] I:  1750/8000 | lr: 0.00042 | l_cls_src: 0.001 | l_cls_tar: 0.418 | l_alg: 0.646 | l_ttl: 0.066 | ent_tar: 0.028 | best_acc: 91.616 
[2022-08-23 06:31:18] I:  1800/8000 | lr: 0.00041 | l_cls_src: 0.004 | l_cls_tar: 0.887 | l_alg: 0.694 | l_ttl: 0.074 | ent_tar: 0.087 | best_acc: 91.616 
[2022-08-23 06:32:08] I:  1850/8000 | lr: 0.00041 | l_cls_src: 0.014 | l_cls_tar: 0.336 | l_alg: 0.638 | l_ttl: 0.078 | ent_tar: 0.081 | best_acc: 91.616 
[2022-08-23 06:32:58] I:  1900/8000 | lr: 0.00040 | l_cls_src: 0.001 | l_cls_tar: 0.130 | l_alg: 0.642 | l_ttl: 0.066 | ent_tar: 0.061 | best_acc: 91.616 
[2022-08-23 06:33:49] I:  1950/8000 | lr: 0.00040 | l_cls_src: 0.001 | l_cls_tar: 0.112 | l_alg: 0.694 | l_ttl: 0.070 | ent_tar: 0.031 | best_acc: 91.616 
[2022-08-23 06:34:37] --> testing on source_test
[2022-08-23 06:35:14]     I:  49/68 | acc: 98.980
[2022-08-23 06:35:27] --> testing on target_test
[2022-08-23 06:35:38] I:  1999/8000 | src_acc: 98.192 | tar_acc: 91.616 | best_acc: 91.616
[2022-08-23 06:35:39]     models saved to exps/bin/ckpt/Foveal2Biop_123/models-last.pt
[2022-08-23 06:35:39]     keys: dict_keys(['optimizer', 'ite', 'best_acc', 'base_net', 'd_net'])
[2022-08-23 06:35:40] I:  2000/8000 | lr: 0.00039 | l_cls_src: 0.000 | l_cls_tar: 0.327 | l_alg: 0.649 | l_ttl: 0.065 | ent_tar: 0.094 | best_acc: 91.616 
[2022-08-23 06:36:30] I:  2050/8000 | lr: 0.00039 | l_cls_src: 0.014 | l_cls_tar: 0.407 | l_alg: 0.713 | l_ttl: 0.085 | ent_tar: 0.077 | best_acc: 91.616 
[2022-08-23 06:37:20] I:  2100/8000 | lr: 0.00038 | l_cls_src: 0.006 | l_cls_tar: 0.264 | l_alg: 0.625 | l_ttl: 0.068 | ent_tar: 0.075 | best_acc: 91.616 
[2022-08-23 06:38:11] I:  2150/8000 | lr: 0.00038 | l_cls_src: 0.001 | l_cls_tar: 0.198 | l_alg: 0.669 | l_ttl: 0.068 | ent_tar: 0.042 | best_acc: 91.616 
[2022-08-23 06:39:01] I:  2200/8000 | lr: 0.00037 | l_cls_src: 0.001 | l_cls_tar: 1.153 | l_alg: 0.628 | l_ttl: 0.063 | ent_tar: 0.070 | best_acc: 91.616 
[2022-08-23 06:39:51] I:  2250/8000 | lr: 0.00037 | l_cls_src: 0.000 | l_cls_tar: 0.861 | l_alg: 0.688 | l_ttl: 0.069 | ent_tar: 0.028 | best_acc: 91.616 
[2022-08-23 06:40:42] I:  2300/8000 | lr: 0.00036 | l_cls_src: 0.003 | l_cls_tar: 0.755 | l_alg: 0.686 | l_ttl: 0.071 | ent_tar: 0.096 | best_acc: 91.616 
[2022-08-23 06:41:32] I:  2350/8000 | lr: 0.00036 | l_cls_src: 0.000 | l_cls_tar: 0.728 | l_alg: 0.624 | l_ttl: 0.063 | ent_tar: 0.044 | best_acc: 91.616 
[2022-08-23 06:42:22] I:  2400/8000 | lr: 0.00035 | l_cls_src: 0.001 | l_cls_tar: 0.746 | l_alg: 0.653 | l_ttl: 0.066 | ent_tar: 0.066 | best_acc: 91.616 
[2022-08-23 06:43:12] I:  2450/8000 | lr: 0.00035 | l_cls_src: 0.001 | l_cls_tar: 0.156 | l_alg: 0.647 | l_ttl: 0.066 | ent_tar: 0.078 | best_acc: 91.616 
[2022-08-23 06:44:00] --> testing on source_test
[2022-08-23 06:44:38]     I:  49/68 | acc: 99.093
[2022-08-23 06:44:51] --> testing on target_test
[2022-08-23 06:45:02] I:  2499/8000 | src_acc: 98.315 | tar_acc: 91.799 | best_acc: 91.799
[2022-08-23 06:45:02]     models saved to exps/bin/ckpt/Foveal2Biop_123/models-last.pt
[2022-08-23 06:45:02]     keys: dict_keys(['optimizer', 'ite', 'best_acc', 'base_net', 'd_net'])
[2022-08-23 06:45:02]     best models saved to exps/bin/ckpt/Foveal2Biop_123/models-best.pt
[2022-08-23 06:45:03] I:  2500/8000 | lr: 0.00035 | l_cls_src: 0.000 | l_cls_tar: 0.125 | l_alg: 0.646 | l_ttl: 0.065 | ent_tar: 0.034 | best_acc: 91.799 
[2022-08-23 06:45:53] I:  2550/8000 | lr: 0.00034 | l_cls_src: 0.002 | l_cls_tar: 0.304 | l_alg: 0.665 | l_ttl: 0.069 | ent_tar: 0.010 | best_acc: 91.799 
[2022-08-23 06:46:44] I:  2600/8000 | lr: 0.00034 | l_cls_src: 0.000 | l_cls_tar: 0.942 | l_alg: 0.651 | l_ttl: 0.065 | ent_tar: 0.040 | best_acc: 91.799 
[2022-08-23 06:47:34] I:  2650/8000 | lr: 0.00033 | l_cls_src: 0.000 | l_cls_tar: 0.547 | l_alg: 0.630 | l_ttl: 0.063 | ent_tar: 0.092 | best_acc: 91.799 
[2022-08-23 06:48:25] I:  2700/8000 | lr: 0.00033 | l_cls_src: 0.003 | l_cls_tar: 0.128 | l_alg: 0.696 | l_ttl: 0.072 | ent_tar: 0.068 | best_acc: 91.799 
[2022-08-23 06:49:15] I:  2750/8000 | lr: 0.00033 | l_cls_src: 0.000 | l_cls_tar: 0.892 | l_alg: 0.673 | l_ttl: 0.068 | ent_tar: 0.078 | best_acc: 91.799 
[2022-08-23 06:50:05] I:  2800/8000 | lr: 0.00032 | l_cls_src: 0.020 | l_cls_tar: 0.383 | l_alg: 0.687 | l_ttl: 0.089 | ent_tar: 0.051 | best_acc: 91.799 
[2022-08-23 06:50:56] I:  2850/8000 | lr: 0.00032 | l_cls_src: 0.001 | l_cls_tar: 0.219 | l_alg: 0.694 | l_ttl: 0.070 | ent_tar: 0.075 | best_acc: 91.799 
[2022-08-23 06:51:46] I:  2900/8000 | lr: 0.00032 | l_cls_src: 0.000 | l_cls_tar: 0.516 | l_alg: 0.623 | l_ttl: 0.062 | ent_tar: 0.050 | best_acc: 91.799 
[2022-08-23 06:52:36] I:  2950/8000 | lr: 0.00031 | l_cls_src: 0.000 | l_cls_tar: 0.386 | l_alg: 0.641 | l_ttl: 0.064 | ent_tar: 0.086 | best_acc: 91.799 
